@let config = modal().config();

@if (isOverlayVisible()) {
  <div class="fm-modals--backdrop"></div>
}

@if (config.closable) {
  <!-- eslint-disable-next-line -->
  <div class="fm-modal--closing-layer" (click)="modal().close()"></div>
}

<div class="fm-modal--body-wrapper" [class]="bodyClasses()" [style]="bodyStyles()">
  <div
    class="fm-modal--body"
    [class.no-border]="!theme().styling.frameBorder"
    [class.no-shadow]="!theme().styling.frameShadow"
  >
    @if (config.closable && (theme().styling.closeBtn === 'inside' || config.stretch)) {
      <div class="fm-modal--header-wrapper">
        <div class="fm-modal--header-content">
          <ng-container *ngTemplateOutlet="headerTpl" />
        </div>

        <div class="fm-modal--header-actions">
          <ng-container *ngTemplateOutlet="closeBtnTpl" />
        </div>
      </div>

    } @else {
      @if (config.closable && !!theme().styling.closeBtn) {
        <ng-container *ngTemplateOutlet="closeBtnTpl" />
      }

      <ng-container *ngTemplateOutlet="headerTpl" />
    }

    <div
      class="fm-modal--content"
      [class.scrollable]="config.scroll === 'content' || config.stretch"
    >
      <ng-content />
    </div>

    <ng-content select="fm-modal-instance-footer" />
  </div>
</div>

<ng-template #closeBtnTpl>
  <div
    tabindex="0"
    class="fm-modal-close-btn"
    (click)="modal().close()"
    (keydown.enter)="modal().close()"
  >
    <span class="line"></span>
    <span class="line"></span>
  </div>
</ng-template>

<ng-template #headerTpl>
  <ng-content select="fm-modal-instance-header" />
</ng-template>
